## Getting Started

### Instructions to register a project in Insightfinder.com
- Go to the link https://insightfinder.com/
- Sign in with the user credentials or sign up for a new account.
- Go to Settings and Register for a project under "Insight Agent" tab.
- Give a project name, select Project Type as "Log" and Agent Type as "Custom".
- Note down the project name and license key which will be used for agent installation. The license key is also available in "User Account Information". To go to "User Account Information", click the userid on the top right corner.

InsightFinder can parse log data sent via logstash. We utilize json_encode filter plugin and http-output plugin to format and send the data. 

### 1. Install LogStash on your machine

Following this [instruction](https://www.elastic.co/guide/en/logstash/current/getting-started-with-logstash.html) to download and install LogStash.

## 2. Install the json_encode filter plugin

``` 
bin/logstash-plugin install logstash-filter-json_encode 
```

### 2. Use sample config to send data

You can follow our sample [config](logstash-if.conf) to send data to the Insightfinder Backend.

### Furthermore

- Try it with different input/filter/codec plugins
- Start LogStash as a service/daemon in your production environment

## Install using Ansible

You can also utilize our Ansible scripts to install logstash and file-beat to monitor the InsightFinder on-prem infrastructure with Jetty and Cassandra configs. Configs you are already using can also be added to the pipeline after the installation.

### Prerequisites:
- Python 2.7
- SSH access to all hosts where agents will be installed are required. SSH key can be generated by following this link:
https://www.ssh.com/ssh/keygen/

Tested with ansible version 2.4

### Install wget to download the required files :
#### For Debian and Ubuntu
```
sudo -E apt-get update
sudo -E apt-get install wget
```
#### For Fedora and RHEL-derivatives
```
sudo -E yum update
sudo -E yum install wget
```
Note: If you are using proxy, the proxy needs to be set for both the current user and root
#### Installation:
1) Use the following command to download the insightfinder agent code. You can skip this step if you have the offline installer package.
```
wget --no-check-certificate https://github.com/insightfinder/InsightAgent/archive/master.tar.gz -O insightagent.tar.gz
or
wget --no-check-certificate http://github.com/insightfinder/InsightAgent/archive/master.tar.gz -O insightagent.tar.gz

```
Untar using this command.
```
tar -xvf insightagent.tar.gz
```
```
cd InsightAgent-master/deployment/DeployAgent/
sudo -E ./installAnsible.sh
```
2) Open and modify the inventory file

```
[nodes]
HOST ansible_user=USER ansible_ssh_private_key_file=SOMETHING
###We can specify the host name with ssh details like this for each host
##If you have the ssh key
#192.168.33.10 ansible_user=vagrant ansible_ssh_private_key_file=/home/private_key
## For localhost use the host below
localhost ansible_connection=local

##If you have the password
#192.168.33.20 ansible_user=vagrant ansible_ssh_pass=ssh_password


##We can also specify the host names here and the ssh details under [nodes:vars] if they have have the same ssh credentials
##(Only one of ansible_ssh_pass OR ansible_ssh_private_key_file is required)
#192.168.33.10
#192.168.33.15

[nodes:vars]
#ansible_user=vagrant
#ansible_ssh_pass=ssh_password
#ansible_ssh_private_key_file=/home/private_key

[all:vars]
##install or uninstall
ifAction=install

##Login User In Insightfinder Application
ifUserName=

##Project Name In Insightfinder Application
ifProjectName=

##User's License Key in Application
ifLicenseKey=

##Sampling interval could be an integer indicating the number of minutes or "10s" indicating 10 seconds.
ifSamplingInterval=1

##Agent type
ifAgent=logstash

##The server reporting Url(Do not change unless you have on-prem deployment)
ifReportingUrl=https://app.insightfinder.com
```


3) Download the agent Code which will be distributed to other machines(not required if you have the offline installation package)
```
cd files
sudo -E ./downloadAgentSSL.sh
or
sudo -E ./downloadAgentNoSSL.sh
```
4) Run the playbook(Go back to the DeployAgent directory)
```
cd ..
ansible-playbook insightagent.yaml
```

**Note:** Logstash will be installed in **/usr/share/logstash** and the configs will be in **/etc/logstash/conf.d/**